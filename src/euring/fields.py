from __future__ import annotations

from .codes import (
    LOOKUP_ACCURACY_PULLUS_AGE,
    LOOKUP_CATCHING_LURES,
    LOOKUP_CATCHING_METHOD,
    LOOKUP_CIRCUMSTANCES,
    LOOKUP_CONDITION,
    LOOKUP_EURING_CODE_IDENTIFIER,
    LOOKUP_MANIPULATED,
    LOOKUP_METAL_RING_INFORMATION,
    LOOKUP_MOVED_BEFORE_ENCOUNTER,
    LOOKUP_PRIMARY_IDENTIFICATION_METHOD,
    LOOKUP_SEX,
    LOOKUP_STATUS,
    LOOKUP_VERIFICATION_OF_THE_METAL_RING,
    lookup_age,
    lookup_brood_size,
    lookup_date,
    lookup_geographical_coordinates,
    lookup_other_marks,
    lookup_place_code,
    lookup_pullus_age,
    lookup_ring_number,
    lookup_ringing_scheme,
    lookup_species,
    parse_geographical_coordinates,
)
from .types import TYPE_ALPHABETIC, TYPE_ALPHANUMERIC, TYPE_INTEGER, TYPE_NUMERIC, TYPE_TEXT

SPEC_MANUAL = "EURING Exchange Code 2020 v202 (13 Nov 2024)"

EURING_FIELDS = [
    dict(name="Ringing Scheme", key="ringing_scheme", type=TYPE_ALPHABETIC, length=3, lookup=lookup_ringing_scheme),
    dict(
        name="Primary identification method",
        key="primary_identification_method",
        type=TYPE_ALPHANUMERIC,
        length=2,
        lookup=LOOKUP_PRIMARY_IDENTIFICATION_METHOD,
    ),
    dict(
        name="Identification number (ring)",
        key="identification_number",
        type=TYPE_ALPHANUMERIC,
        length=10,
        lookup=lookup_ring_number,
    ),
    dict(
        name="Verification of the metal ring",
        key="verification_of_the_metal_ring",
        type=TYPE_INTEGER,
        length=1,
        lookup=LOOKUP_VERIFICATION_OF_THE_METAL_RING,
    ),
    dict(
        name="Metal ring information",
        key="metal_ring_information",
        type=TYPE_INTEGER,
        length=1,
        lookup=LOOKUP_METAL_RING_INFORMATION,
    ),
    dict(
        name="Other marks information",
        key="other_marks_information",
        type=TYPE_ALPHABETIC,
        length=2,
        lookup=lookup_other_marks,
    ),
    dict(name="Species mentioned", key="species_mentioned", type=TYPE_INTEGER, length=5, lookup=lookup_species),
    dict(name="Species concluded", key="species_concluded", type=TYPE_INTEGER, length=5, lookup=lookup_species),
    dict(name="Manipulated", key="manipulated", type=TYPE_ALPHABETIC, length=1, lookup=LOOKUP_MANIPULATED),
    dict(
        name="Moved before recovery",
        key="moved_before_recovery",
        type=TYPE_INTEGER,
        length=1,
        lookup=LOOKUP_MOVED_BEFORE_ENCOUNTER,
    ),
    dict(name="Catching method", key="catching_method", type=TYPE_ALPHABETIC, length=1, lookup=LOOKUP_CATCHING_METHOD),
    dict(name="Catching lures", key="catching_lures", type=TYPE_ALPHABETIC, length=1, lookup=LOOKUP_CATCHING_LURES),
    dict(name="Sex mentioned", key="sex_mentioned", type=TYPE_ALPHABETIC, length=1, lookup=LOOKUP_SEX),
    dict(name="Sex concluded", key="sex_concluded", type=TYPE_ALPHABETIC, length=1, lookup=LOOKUP_SEX),
    dict(name="Age mentioned", key="age_mentioned", type=TYPE_ALPHANUMERIC, length=1, lookup=lookup_age),
    dict(name="Age concluded", key="age_concluded", type=TYPE_ALPHANUMERIC, length=1, lookup=lookup_age),
    dict(name="Status", key="status", type=TYPE_ALPHABETIC, length=1, lookup=LOOKUP_STATUS),
    dict(name="Brood size", key="brood_size", type=TYPE_INTEGER, length=2, lookup=lookup_brood_size),
    dict(name="Pullus age", key="pullus_age", type=TYPE_INTEGER, length=2, lookup=lookup_pullus_age),
    dict(
        name="Accuracy of pullus age",
        key="accuracy_of_pullus_age",
        type=TYPE_ALPHANUMERIC,
        length=1,
        lookup=LOOKUP_ACCURACY_PULLUS_AGE,
    ),
    dict(name="Date", key="date", type=TYPE_INTEGER, length=8, lookup=lookup_date),
    dict(name="Accuracy of date", key="accuracy_of_date", type=TYPE_INTEGER, length=1),
    dict(name="Time", key="time", type=TYPE_ALPHANUMERIC, length=4),
    dict(name="Place Code", key="place_code", type=TYPE_ALPHANUMERIC, length=4, lookup=lookup_place_code),
    dict(
        name="Geographical co-ordinates",
        key="geographical_coordinates",
        type=TYPE_ALPHANUMERIC,
        length=15,
        parser=parse_geographical_coordinates,
        lookup=lookup_geographical_coordinates,
    ),
    dict(name="Accuracy of co-ordinates", key="accuracy_of_coordinates", type=TYPE_INTEGER, length=1),
    dict(name="Condition", key="condition", type=TYPE_INTEGER, length=1, lookup=LOOKUP_CONDITION),
    dict(name="Circumstances", key="circumstances", type=TYPE_INTEGER, length=2, lookup=LOOKUP_CIRCUMSTANCES),
    dict(name="Circumstances presumed", key="circumstances_presumed", type=TYPE_INTEGER, length=1),
    dict(
        name="EURING Code identifier",
        key="euring_code_identifier",
        type=TYPE_INTEGER,
        length=1,
        lookup=LOOKUP_EURING_CODE_IDENTIFIER,
    ),
    dict(name="Derived data - distance", key="derived_data_distance", type=TYPE_INTEGER, min_length=0, max_length=5),
    dict(name="Derived data - direction", key="derived_data_direction", type=TYPE_INTEGER, length=3),
    dict(
        name="Derived data - elapsed time",
        key="derived_data_elapsed_time",
        type=TYPE_INTEGER,
        min_length=0,
        max_length=5,
    ),
    # Starting with Wing Length, fields are no longer required. Source: EURING Exchange Code 2020 v202 (13 Nov 2024).
    dict(name="Wing length", key="wing_length", type=TYPE_NUMERIC, required=False),
    dict(name="Third primary", key="third_primary", type=TYPE_NUMERIC, required=False),
    dict(name="State of wing point", key="state_of_wing_point", type=TYPE_ALPHABETIC, length=1, required=False),
    dict(name="Mass", key="mass", type=TYPE_NUMERIC, required=False),
    dict(name="Moult", key="moult", type=TYPE_ALPHABETIC, length=1, required=False),
    dict(name="Plumage code", key="plumage_code", type=TYPE_ALPHANUMERIC, length=1, required=False),
    dict(name="Hind claw", key="hind_claw", type=TYPE_NUMERIC, required=False),
    dict(name="Bill length", key="bill_length", type=TYPE_NUMERIC, required=False),
    dict(name="Bill method", key="bill_method", type=TYPE_ALPHABETIC, length=1, required=False),
    dict(name="Total head length", key="total_head_length", type=TYPE_NUMERIC, required=False),
    dict(name="Tarsus", key="tarsus", type=TYPE_NUMERIC, required=False),
    dict(name="Tarsus method", key="tarsus_method", type=TYPE_ALPHABETIC, length=1, required=False),
    dict(name="Tail length", key="tail_length", type=TYPE_NUMERIC, required=False),
    dict(name="Tail diference", key="tail_difference", type=TYPE_NUMERIC, required=False),
    dict(name="Fat score", key="fat_score", type=TYPE_INTEGER, length=1, required=False),
    dict(name="Fat score method", key="fat_score_method", type=TYPE_ALPHABETIC, length=1, required=False),
    dict(name="Pectoral muscle", key="pectoral_muscle", type=TYPE_INTEGER, length=1, required=False),
    dict(name="Brood patch", key="brood_patch", type=TYPE_ALPHANUMERIC, length=1, required=False),
    dict(name="Primary score", key="primary_score", type=TYPE_INTEGER, max_length=2, required=False),
    dict(name="Primary moult", key="primary_moult", type=TYPE_ALPHANUMERIC, length=10, required=False),
    dict(name="Old greater coverts", key="old_greater_coverts", type=TYPE_INTEGER, length=1, required=False),
    dict(name="Alula", key="alula", type=TYPE_INTEGER, length=1, required=False),
    dict(name="Carpal covert", key="carpal_covert", type=TYPE_INTEGER, length=1, required=False),
    dict(name="Sexing method", key="sexing_method", type=TYPE_ALPHABETIC, length=1, required=False),
    dict(name="Place name", key="place_name", type=TYPE_TEXT, required=False),
    dict(name="Remarks", key="remarks", type=TYPE_TEXT, required=False),
    dict(name="Reference", key="reference", type=TYPE_TEXT, required=False),
]
